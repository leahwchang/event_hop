<!DOCTYPE html>
<html>
	<head>
	  <title>EventHop</title>
	  <%= stylesheet_link_tag 'application', media: 'all', 'data-turbolinks-track' => true %>
	  <%= javascript_include_tag 'application', 'data-turbolinks-track' => true %>
	  <%= csrf_meta_tags %>

	  <!-- google font -->
		<link href='https://fonts.googleapis.com/css?family=Josefin+Sans|Oleo+Script' rel='stylesheet' type='text/css'>
	</head>

	<body>
		<nav class="headernav">
			<ul>
				<% if user_signed_in? %>
					<% if current_user.fname %>
					<b>Welcome Back</b> <%= current_user.fname + " " + current_user.email %>
					<% end %>
					<% if current_user[:admin] == true %>
					<div class="link"><%= link_to 'create new place', new_place_path %> </div>
					<% end %>
					<div class="link"><%= link_to 'sign out', destroy_user_session_path, method: :delete %></div>
					<div class="link"><%=  link_to 'profile', user_path(current_user.id) %></div>
					<div class="link"><%= link_to 'home', places_path %></div>
				<% else %>
				<div class="link"><%= link_to 'sign up', new_user_registration_path %></div>
				<div class="link"><%= link_to 'log in', new_user_session_path %></div>
				<% end %>
			</ul>
		</nav>

	<% if notice %>
		<p class="notice"><%= notice %></p>
	<% end %>

	<% if alert %>
		<p class="alert"><%= alert %></p>
	<% end %>

	<%= yield %>

	<footer>
		<div id="footernav">
			<br />
				<ul>
					<li>
						<%= link_to image_tag("facebook.png"), "http://www.facebook.com" %>
					</li>
					<li>
						<%= link_to image_tag("twitter.png"), "http://www.twitter.com" %>
					</li>
					<li>
						<%= link_to image_tag("instagram.png"), "http://www.instagram.com" %>
					</li>
				</ul>
		</div>
	</footer>

	<!-- gmaps4rails -->
	<script src="//maps.google.com/maps/api/js?key=<%= ENV['EVENTHOP_GMAPS_API_KEY'] %>"></script>
	<script src="//cdn.rawgit.com/mahnunchik/markerclustererplus/master/dist/markerclusterer.min.js"></script>

	<script type="text/javascript">

	// function initialize() {
		if ($('#map-canvas').length > 0) {
	    handler = Gmaps.build('Google');
	    handler.buildMap(
	      {provider: {}, internal: {id: 'map-canvas'}},
	      function() {
	        markers = handler.addMarkers(<%= raw @hash.to_json %>);
	        handler.bounds.extendWith(markers);
	        handler.fitMapToBounds();
	      });
	  }
  // }
	// addMarkers.setMap(null);
  // google.maps.event.addDomListener(window, 'page:load', initialize);

	</script>

	</body>
</html>
